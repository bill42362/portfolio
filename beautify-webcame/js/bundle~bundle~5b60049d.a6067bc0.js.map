{"version":3,"sources":["webpack:///./src/client/js/style/ResetButtonStyle.js","webpack:///./src/client/js/component/MediaStreamHandler.jsx","webpack:///./src/client/js/component/FilterPanel.jsx","webpack:///./src/client/js/component/SliceMonitor.jsx","webpack:///./src/client/js/component/GaussianBlurPanel.jsx","webpack:///./src/client/js/component/HardLightPanel.jsx","webpack:///./src/client/js/resource/WebGL.js","webpack:///./src/client/js/shaderSource/mirrorVertex.js","webpack:///./src/client/js/shaderSource/greenBlueChannelFragment.js","webpack:///./src/client/js/resource/GreenBlueChannel.js","webpack:///./src/client/js/shaderSource/gaussianBlurFragment.js","webpack:///./src/client/js/resource/GaussianBlurFilter.js","webpack:///./src/client/js/shaderSource/highPassFilterFragment.js","webpack:///./src/client/js/resource/HighPassFilter.js","webpack:///./src/client/js/shaderSource/hardLightFragment.js","webpack:///./src/client/js/resource/HardLight.js","webpack:///./src/client/js/resource/CardinalSpline.js","webpack:///./src/client/js/shaderSource/toneCurveFragment.js","webpack:///./src/client/js/resource/ToneCurve.js","webpack:///./src/client/js/shaderSource/maskBlenderFragment.js","webpack:///./src/client/js/resource/MaskBlender.js","webpack:///./src/client/js/shaderSource/fillColorFragment.js","webpack:///./src/client/js/resource/FillColor.js","webpack:///./src/client/js/shaderSource/mirrorFragment.js","webpack:///./src/client/js/resource/CopyTexture.js","webpack:///./src/client/js/resource/BeautifyFilter.js","webpack:///./src/client/js/component/Main.jsx","webpack:///./src/client/img/github-icon.svg","webpack:///./src/client/js/component/Footer.jsx","webpack:///./src/client/img/email-icon.svg","webpack:///./src/client/img/x-men-school.svg","webpack:///./src/client/js/component/App.jsx","webpack:///./src/client/js/index.js"],"names":["ResetButtonStyle","css","MediaStreamHandler","state","isStarted","shouldPreview","mediaStream","error","video","React","createRef","startRecording","props","onChange","onError","setState","navigator","mediaDevices","getUserMedia","facingMode","stream","value","target","stopRecording","getTracks","forEach","track","stop","renderDescription","id","JSON","stringify","message","renderBody","ref","playsInline","handleTogglePreview","_","prevState","this","current","srcObject","play","StyledMediaStreamHandler","Header","StopButton","onClick","StartButton","ToggleButton","isActived","disabled","PureComponent","propTypes","PropTypes","func","defaultProps","styled","div","Body","Footer","Button","button","attrs","style","backgroundColor","FilterPanel","filterName","filterCore","pixelSource","useState","shouldAnimate","setShouldAnimate","maxFps","setMaxFps","fps","setFps","animationFrame","useRef","lastFrameTimestamp","canvasRef","useEffect","window","cancelAnimationFrame","requestAnimationFrame","animate","timestamp","minInterval","elapsed","context","getContext","sourceWidth","canvas","width","sourceHeight","height","nodeName","videoWidth","videoHeight","draw","canvasWidth","canvasHeight","clearRect","drawImage","nextFrame","Math","ceil","StyledFilterPanel","DrawButton","Controls","Label","type","min","max","step","e","string","object","label","SliceMonitor","sliceName","StyledSliceMonitor","isRequired","GaussianBlurPanel","radius","sigma","StyledGaussianBlur","number","HardLightPanel","cycles","StyledHardLight","createShader","source","shader","shaderSource","compileShader","createProgram","vertexShaderSource","fragmentShaderSource","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","console","getProgramInfoLog","getShaderInfoLog","deleteShader","deleteProgram","createBuffer","attribute","buffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","array","STATIC_DRAW","numComponents","count","floor","length","FLOAT","normalize","offset","stride","dockBuffer","location","vertexAttribPointer","mirrorVertex","greenBlueChannelFragment","GreenBlueChannel","Error","core","mirrorVertexShaderSource","greenBlueChannelFragmentShaderSource","aPosition","getAttribLocation","aTextCoord","enableVertexAttribArray","uIsFrameBuffer","getUniformLocation","uSource","prototype","key","includes","sourceTexture","sourceTextureIndex","targetFrameBuffer","useProgram","bindTexture","TEXTURE_2D","uniform1i","bindFramebuffer","FRAMEBUFFER","drawArrays","TRIANGLES","gaussianBlurFragment","getKernal","inputRadius","abs","sigma2","data","Array","sum","x","index","exp","sqrt","PI","normalizedData","map","GaussianBlurFilter","gaussianBlurFragmentShaderSource","uResolution","uKernalRadius","uKernelData","uIsVertical","updateKernal","isNaN","_radius","_sigma","_kernal","uniform1fv","midFrameBuffer","midTexture","midTextureIndex","uniform2f","highPassFilterFragment","HighPassFilter","highPassFilterFragmentShaderSource","uBlurredSource","blurredSourceTexture","blurredSourceTextureIndex","hardLightFragment","HardLight","hardLightFragmentShaderSource","uCycles","updateCycles","_cycles","mk1","tension","k0","k2","y","getPolynomial","p0","p1","p2","p3","t","h00","h10","h01","h11","getPaddedPoints","points","ptail0","ptail1","getPolynomials","sortedPoints","sort","a","b","padPoints","slice","point","startPoint","stopPoint","polynomial","getCurvePoint","polynomials","find","p","getCurvePoints","fill","toneCurveFragment","defaultRedControlPoints","defaultControlPoints","red","green","blue","ToneCurve","toneMapTexture","toneMapTextureIndex","strength","controlPoints","toneCurveFragmentShaderSource","uStrength","uTone","updateStrength","updateCurvePoints","_strength","uniform1f","_controlPoints","_tension","_curvePoints","_curveImageData","ImageData","Uint8ClampedArray","flatMap","texImage2D","RGBA","UNSIGNED_BYTE","maskBlenderFragment","MaskBlender","maskBlenderFragmentShaderSource","uMask","uBlendSource","maskTexture","maskTextureIndex","blendSourceTexture","blendSourceTextureIndex","fillColorFragment","FillColor","color","fillColorFragmentShaderSource","uColor","updateColor","isArray","_color","uniform4f","mirrorFragment","CopyTexture","mirrorFragmentShaderSource","textureNames","frameBufferNames","textureIndex","reduce","textureName","clearColor","positionAttribute","textCoordAttribute","BeautifyFilter","document","createElement","texture","name","ctx","createTexture","activeTexture","TEXTURE0","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","frameBuffer","createFramebuffer","framebufferTexture2D","COLOR_ATTACHMENT0","greenBlueChannel","gaussianBlur","highPassFilter","hardLight","toneCurve","toneMap","maskBlender","fillColor","copyTexture","updateCanvasSize","clear","COLOR_BUFFER_BIT","exportTextureToCanvases","canvases","gaussianBlurMid","viewport","Object","keys","textureKey","registerSlice","push","targetContexts","filter","Boolean","targetContext","sourceCanvas","targetWidth","targetHeight","updateGaussianBlurKernal","updateHardLightCycles","StyledMain","Modules","ModuleWrapper","Main","setMediaStream","setGaussianBlur","setHardLight","sourceVideo","beautifyFilter","sourceCanvasRef","greenBlueCanvasRef","gaussianBlurCanvasRef","hardLightCanvasRef","toneCurveCanvasRef","setAttribute","pause","email","github","StyledFooter","Link","href","src","GithubIcon","alt","GlobalStyle","createGlobalStyle","styledNormalize","title","description","App","request","log","Helmet","defaultTitle","titleTemplate","charSet","content","property","StyledApp","XMenLogoSource","sheet","instance","ReactDOM","render","getElementById"],"mappings":"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","file":"js/bundle~bundle~5b60049d.a6067bc0.js","sourcesContent":["// ResetButtonStyle.js\n'use strict';\nimport { css } from 'styled-components';\n\nexport const ResetButtonStyle = css`\n  border: none;\n  padding: 0px;\n  outline: none;\n  background: none;\n`;\n\nexport default ResetButtonStyle;\n","// MediaStreamHandler.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nimport ResetButtonStyle from '../style/ResetButtonStyle.js';\n\nexport class MediaStreamHandler extends React.PureComponent {\n  state = {\n    isStarted: false,\n    shouldPreview: false,\n    mediaStream: null,\n    error: false,\n  };\n  video = React.createRef();\n\n  startRecording = async () => {\n    const { onChange, onError } = this.props;\n    try {\n      this.setState({ isStarted: true });\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: { facingMode: 'environment' },\n      });\n      this.setState({ mediaStream: stream });\n      return onChange({ value: stream });\n    } catch (error) {\n      this.setState({ error, isStarted: false });\n      return onError({ error, target: this });\n    }\n  };\n\n  stopRecording = () => {\n    const { mediaStream } = this.state;\n    const { onChange } = this.props;\n    if (mediaStream) {\n      const tracks = mediaStream.getTracks();\n      tracks.forEach(track => track.stop());\n      onChange({ value: null });\n      this.setState({\n        mediaStream: null,\n        isStarted: false,\n        shouldPreview: false,\n      });\n    }\n  };\n\n  componentDidUpdate(_, prevState) {\n    const { mediaStream, shouldPreview } = this.state;\n    if (shouldPreview && shouldPreview !== prevState.shouldPreview) {\n      this.video.current.srcObject = mediaStream;\n      this.video.current.play();\n    }\n  }\n\n  componentWillUnmount() {\n    this.stopRecording();\n  }\n\n  renderDescription = () => {\n    const { isStarted, mediaStream, error } = this.state;\n\n    if (isStarted) {\n      if (mediaStream) {\n        return `Media stream id: ${mediaStream.id}`;\n      } else {\n        return 'Loading mediaStream ...';\n      }\n    }\n\n    if (error) {\n      return `Error: ${JSON.stringify(error.message)}`;\n    }\n\n    return 'Idle';\n  };\n\n  renderBody = () => {\n    const { shouldPreview } = this.state;\n    return (\n      <Body>\n        <div>{this.renderDescription()}</div>\n        {shouldPreview && <video ref={this.video} playsInline />}\n      </Body>\n    );\n  };\n\n  handleTogglePreview = () => {\n    const { mediaStream, shouldPreview } = this.state;\n    if (!mediaStream) {\n      return;\n    }\n    return this.setState({ shouldPreview: !shouldPreview });\n  };\n\n  render() {\n    const { mediaStream, shouldPreview } = this.state;\n    return (\n      <StyledMediaStreamHandler>\n        <Header>MediaStreamHandler</Header>\n        {this.renderBody()}\n        <Footer>\n          {mediaStream ? (\n            <StopButton onClick={this.stopRecording}>Stop</StopButton>\n          ) : (\n            <StartButton onClick={this.startRecording}>Start</StartButton>\n          )}\n          <ToggleButton\n            isActived={shouldPreview}\n            disabled={!mediaStream}\n            onClick={this.handleTogglePreview}\n          >\n            Preview\n          </ToggleButton>\n        </Footer>\n      </StyledMediaStreamHandler>\n    );\n  }\n}\n\nMediaStreamHandler.propTypes = {\n  onChange: PropTypes.func,\n  onError: PropTypes.func,\n};\n\nMediaStreamHandler.defaultProps = {\n  onChange: () => null,\n  onError: () => null,\n};\n\nconst StyledMediaStreamHandler = styled.div`\n  border: solid 1px #4834d4;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Header = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Body = styled.div`\n  position: relative;\n  background-color: #686de0;\n  padding: 8px;\n  & > video {\n    margin-top: 8px;\n    width: 100%;\n  }\n`;\n\nconst Footer = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Button = styled.button`\n  ${ResetButtonStyle}\n  border-radius: 4px;\n  padding: 4px;\n  color: white;\n  font-size: 14px;\n  & + & {\n    margin-left: 8px;\n  }\n`;\n\nconst StartButton = styled(Button)`\n  background-color: #6ab04c;\n`;\n\nconst StopButton = styled(Button)`\n  background-color: #eb4d4b;\n`;\n\nconst ToggleButton = styled(Button).attrs(({ isActived }) => {\n  return {\n    style: {\n      backgroundColor: isActived ? '#6ab04c' : '#badc58',\n    },\n  };\n})``;\n\nexport default MediaStreamHandler;\n","// FilterPanel.jsx\nimport React, { useState, useRef, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nimport ResetButtonStyle from '../style/ResetButtonStyle.js';\n\nconst FilterPanel = ({ filterName, filterCore, pixelSource }) => {\n  const [shouldAnimate, setShouldAnimate] = useState(false);\n  const [maxFps, setMaxFps] = useState(30);\n  const [fps, setFps] = useState(0);\n\n  const animationFrame = useRef();\n  const lastFrameTimestamp = useRef(0);\n  const canvasRef = useRef();\n\n  useEffect(() => {\n    const nextFrame = () => {\n      const context = canvasRef.current.getContext('2d');\n      if (!context) {\n        return;\n      }\n\n      let sourceWidth = context.canvas.width;\n      let sourceHeight = context.canvas.height;\n      if ('VIDEO' == pixelSource.nodeName) {\n        sourceWidth = pixelSource.videoWidth;\n        sourceHeight = pixelSource.videoHeight;\n      } else if ('CANVAS' === pixelSource.nodeName) {\n        sourceWidth = pixelSource.width;\n        sourceHeight = pixelSource.height;\n      }\n\n      if (!sourceWidth || !sourceHeight) {\n        return;\n      }\n\n      filterCore.draw({ pixelSource });\n\n      const canvasWidth = context.canvas.width;\n      const canvasHeight = context.canvas.height;\n      if (canvasWidth !== sourceWidth || canvasHeight !== sourceHeight) {\n        context.canvas.width = sourceWidth;\n        context.canvas.height = sourceHeight;\n      }\n\n      context.clearRect(0, 0, sourceWidth, sourceHeight);\n      context.drawImage(filterCore.canvas, 0, 0);\n    };\n\n    const animate = timestamp => {\n      if (shouldAnimate) {\n        animationFrame.current = window.requestAnimationFrame(animate);\n      }\n      const minInterval = 1000 / maxFps;\n      const elapsed = timestamp - lastFrameTimestamp.current;\n      if (elapsed >= minInterval) {\n        lastFrameTimestamp.current = timestamp;\n        nextFrame();\n        setFps(Math.ceil(1000 / elapsed));\n      }\n    };\n\n    if (!shouldAnimate) {\n      window.cancelAnimationFrame(animationFrame.current);\n      return;\n    }\n\n    window.cancelAnimationFrame(animationFrame.current);\n    animationFrame.current = window.requestAnimationFrame(animate);\n    return () => window.cancelAnimationFrame(animationFrame.current);\n  }, [shouldAnimate, maxFps, filterCore, pixelSource]);\n\n  return (\n    <StyledFilterPanel>\n      <Header>{filterName}</Header>\n      <Body>\n        <canvas ref={canvasRef} />\n      </Body>\n      <Footer>\n        <DrawButton\n          isActived={shouldAnimate}\n          disabled={!pixelSource}\n          onClick={() => setShouldAnimate(!shouldAnimate)}\n        >\n          Draw\n        </DrawButton>\n        <span>FPS: {fps}</span>\n        <Controls>\n          <Label>\n            <span>Max FPS: {maxFps}</span>\n            <input\n              type=\"range\"\n              min=\"1\"\n              max=\"60\"\n              step=\"1\"\n              value={maxFps}\n              onChange={e => setMaxFps(e.target.value)}\n            />\n          </Label>\n        </Controls>\n      </Footer>\n    </StyledFilterPanel>\n  );\n};\n\nFilterPanel.propTypes = {\n  filterName: PropTypes.string,\n  filterCore: PropTypes.object,\n  pixelSource: PropTypes.object,\n};\n\nFilterPanel.defaultProps = {\n  filterName: '',\n  filterCore: null,\n  pixelSource: null,\n};\n\nconst StyledFilterPanel = styled.div`\n  border: solid 1px #4834d4;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Header = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Body = styled.div`\n  position: relative;\n  background-color: #686de0;\n  padding: 8px;\n  & > canvas {\n    width: 100%;\n  }\n`;\n\nconst Button = styled.button`\n  ${ResetButtonStyle}\n  border-radius: 4px;\n  padding: 4px;\n  color: white;\n  font-size: 14px;\n  & + & {\n    margin-left: 8px;\n  }\n`;\n\nconst Footer = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n  button + span {\n    margin-left: 8px;\n  }\n`;\n\nconst DrawButton = styled(Button).attrs(({ isActived }) => {\n  return {\n    style: {\n      backgroundColor: isActived ? '#6ab04c' : '#badc58',\n    },\n  };\n})``;\n\nconst Controls = styled.div`\n  margin-top: 8px;\n`;\n\nconst Label = styled.label`\n  display: flex;\n\n  input {\n    flex: 1;\n    margin-left: 8px;\n  }\n`;\n\nexport default FilterPanel;\n","// SliceMonitor.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst SliceMonitor = ({ sliceName, canvasRef }) => {\n  return (\n    <StyledSliceMonitor>\n      <Header>{sliceName}</Header>\n      <Body>\n        <canvas ref={canvasRef} />\n      </Body>\n      <Footer></Footer>\n    </StyledSliceMonitor>\n  );\n};\n\nSliceMonitor.propTypes = {\n  sliceName: PropTypes.string,\n  canvasRef: PropTypes.object.isRequired,\n};\n\nSliceMonitor.defaultProps = {\n  sliceName: '',\n};\n\nconst StyledSliceMonitor = styled.div`\n  border: solid 1px #4834d4;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Header = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Body = styled.div`\n  position: relative;\n  background-color: #686de0;\n  padding: 8px;\n  & > canvas {\n    width: 100%;\n  }\n`;\n\nconst Footer = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n  button + span {\n    margin-left: 8px;\n  }\n`;\n\nexport default SliceMonitor;\n","// GaussianBlurPanel.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst GaussianBlurPanel = ({ canvasRef, radius, sigma, onChange }) => {\n  return (\n    <StyledGaussianBlur>\n      <Header>GaussianBlurPanel</Header>\n      <Body>\n        <canvas ref={canvasRef} />\n      </Body>\n      <Footer>\n        <Controls>\n          <Label>\n            <span>Radius: {radius}</span>\n            <input\n              type=\"range\"\n              min=\"1\"\n              max=\"32\"\n              step=\"1\"\n              value={radius}\n              onChange={e => onChange({ radius: +e.target.value, sigma })}\n            />\n          </Label>\n          <Label>\n            <span>Sigma: {sigma}</span>\n            <input\n              type=\"range\"\n              min=\"0.1\"\n              max=\"20\"\n              step=\"0.1\"\n              value={sigma}\n              onChange={e => onChange({ sigma: +e.target.value, radius })}\n            />\n          </Label>\n        </Controls>\n      </Footer>\n    </StyledGaussianBlur>\n  );\n};\n\nGaussianBlurPanel.propTypes = {\n  canvasRef: PropTypes.object.isRequired,\n  radius: PropTypes.number,\n  sigma: PropTypes.number,\n  onChange: PropTypes.func,\n};\n\nGaussianBlurPanel.defaultProps = {\n  radius: 16,\n  sigma: 16,\n  onChange: () => null,\n};\n\nconst StyledGaussianBlur = styled.div`\n  border: solid 1px #4834d4;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Header = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Body = styled.div`\n  position: relative;\n  background-color: #686de0;\n  padding: 8px;\n  & > canvas {\n    width: 100%;\n  }\n`;\n\nconst Footer = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n  button + span {\n    margin-left: 8px;\n  }\n`;\n\nconst Controls = styled.div`\n  margin-top: 8px;\n`;\n\nconst Label = styled.label`\n  display: flex;\n\n  input {\n    flex: 1;\n    margin-left: 8px;\n  }\n`;\n\nexport default GaussianBlurPanel;\n","// HardLightPanel.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nconst HardLightPanel = ({ canvasRef, cycles, onChange }) => {\n  return (\n    <StyledHardLight>\n      <Header>HardLightPanel</Header>\n      <Body>\n        <canvas ref={canvasRef} />\n      </Body>\n      <Footer>\n        <Controls>\n          <Label>\n            <span>Cycles: {cycles}</span>\n            <input\n              type=\"range\"\n              min=\"1\"\n              max=\"8\"\n              step=\"1\"\n              value={cycles}\n              onChange={e => onChange({ cycles: +e.target.value })}\n            />\n          </Label>\n        </Controls>\n      </Footer>\n    </StyledHardLight>\n  );\n};\n\nHardLightPanel.propTypes = {\n  canvasRef: PropTypes.object.isRequired,\n  cycles: PropTypes.number,\n  onChange: PropTypes.func,\n};\n\nHardLightPanel.defaultProps = {\n  cycles: 3,\n  onChange: () => null,\n};\n\nconst StyledHardLight = styled.div`\n  border: solid 1px #4834d4;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst Header = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n`;\n\nconst Body = styled.div`\n  position: relative;\n  background-color: #686de0;\n  padding: 8px;\n  & > canvas {\n    width: 100%;\n  }\n`;\n\nconst Footer = styled.div`\n  background-color: #4834d4;\n  padding: 8px;\n  button + span {\n    margin-left: 8px;\n  }\n`;\n\nconst Controls = styled.div`\n  margin-top: 8px;\n`;\n\nconst Label = styled.label`\n  display: flex;\n\n  input {\n    flex: 1;\n    margin-left: 8px;\n  }\n`;\n\nexport default HardLightPanel;\n","// WebGL.js\nconst createShader = (context, type, source) => {\n  const shader = context.createShader(type);\n  context.shaderSource(shader, source);\n  context.compileShader(shader);\n  return shader;\n};\n\nexport const createProgram = ({\n  context,\n  vertexShaderSource,\n  fragmentShaderSource,\n}) => {\n  if (!context || !vertexShaderSource || !fragmentShaderSource) {\n    return;\n  }\n  const vertexShader = createShader(\n    context,\n    context.VERTEX_SHADER,\n    vertexShaderSource\n  );\n  const fragmentShader = createShader(\n    context,\n    context.FRAGMENT_SHADER,\n    fragmentShaderSource\n  );\n  const program = context.createProgram();\n  context.attachShader(program, vertexShader);\n  context.attachShader(program, fragmentShader);\n  context.linkProgram(program);\n  const success = context.getProgramParameter(program, context.LINK_STATUS);\n  if (success) {\n    return { vertexShader, fragmentShader, program };\n  }\n  // eslint-disable-next-line no-console\n  console.error('Link failed:', context.getProgramInfoLog(program));\n  // eslint-disable-next-line no-console\n  console.error('vs info-log:', context.getShaderInfoLog(vertexShader));\n  // eslint-disable-next-line no-console\n  console.error('fs info-log:', context.getShaderInfoLog(fragmentShader));\n  context.deleteShader(vertexShader);\n  context.deleteShader(fragmentShader);\n  context.deleteProgram(program);\n  return;\n};\n\nexport const clearGlCore = ({\n  context,\n  vertexShader,\n  fragmentShader,\n  program,\n} = {}) => {\n  if (!context) {\n    return;\n  }\n  vertexShader && context.deleteShader(vertexShader);\n  fragmentShader && context.deleteShader(fragmentShader);\n  program && context.deleteProgram(program);\n};\n\nexport const createBuffer = ({ context, attribute }) => {\n  const buffer = context.createBuffer();\n  context.bindBuffer(context.ARRAY_BUFFER, buffer);\n  context.bufferData(\n    context.ARRAY_BUFFER,\n    new Float32Array(attribute.array),\n    context.STATIC_DRAW\n  );\n  return {\n    buffer,\n    numComponents: attribute.numComponents,\n    count: Math.floor(attribute.array.length / attribute.numComponents),\n    type: context.FLOAT,\n    normalize: false,\n    offset: 0,\n    // how many bytes to get from one set of values to the next\n    // 0 = use type and numComponents above\n    stride: 0,\n  };\n};\n\nexport const createTexture = ({ context, index = 0 }) => {\n  const ctx = context;\n  const texture = ctx.createTexture();\n  ctx.activeTexture(ctx.TEXTURE0 + index);\n  ctx.bindTexture(ctx.TEXTURE_2D, texture);\n  ctx.texParameteri(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_S, ctx.CLAMP_TO_EDGE);\n  ctx.texParameteri(ctx.TEXTURE_2D, ctx.TEXTURE_WRAP_T, ctx.CLAMP_TO_EDGE);\n  ctx.texParameteri(ctx.TEXTURE_2D, ctx.TEXTURE_MIN_FILTER, ctx.NEAREST);\n  ctx.texParameteri(ctx.TEXTURE_2D, ctx.TEXTURE_MAG_FILTER, ctx.NEAREST);\n  // setup default texture data\n  ctx.texImage2D(\n    ctx.TEXTURE_2D,\n    0, // level\n    ctx.RGBA, // internal format\n    ctx.canvas.width,\n    ctx.canvas.height,\n    0, // border\n    ctx.RGBA, // src format\n    ctx.UNSIGNED_BYTE, // src type\n    null\n  );\n  return texture;\n};\n\nexport const dockBuffer = ({ context, location, buffer }) => {\n  context.bindBuffer(context.ARRAY_BUFFER, buffer.buffer);\n  context.vertexAttribPointer(\n    location,\n    buffer.numComponents,\n    buffer.type,\n    buffer.normalize,\n    buffer.stride,\n    buffer.offset\n  );\n};\n","// mirrorVertex.js\n\nconst mirrorVertex = `#version 300 es\nin vec4 aPosition;\nin vec2 aTextCoord;\nuniform int uIsFrameBuffer;\nout vec2 vTextCoord;\n\nvoid main() {\n  vec4 position = aPosition;\n  if (1 == uIsFrameBuffer) {\n    // frame buffer axis is opposite with canvas.\n    position.y = -aPosition.y;\n  }\n  gl_Position = position;\n  vTextCoord = aTextCoord;\n}\n`;\n\nexport default mirrorVertex;\n","// greenBlueChannelFragment.js\n\nconst greenBlueChannelFragment = `#version 300 es\nprecision highp float;\n\nuniform sampler2D uSource;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec4 originColor = texture(uSource, vTextCoord);\n  float gbColor = 2.0 * originColor.b * originColor.g;\n  outColor = vec4(gbColor, gbColor, gbColor, originColor.a);\n}\n`;\n\nexport default greenBlueChannelFragment;\n","// GreenBlueChannel.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport greenBlueChannelFragmentShaderSource from '../shaderSource/greenBlueChannelFragment.js';\n\nconst GreenBlueChannel = function ({ context } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: greenBlueChannelFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n};\n\nGreenBlueChannel.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nGreenBlueChannel.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default GreenBlueChannel;\n","// gaussianBlurFragment.js\n\nconst gaussianBlurFragment = `#version 300 es\nprecision highp float;\n\nuniform sampler2D uSource;\nuniform vec2 uResolution;\nuniform int uKernalRadius;\nuniform float uKernelData[65];\nuniform int uIsVertical;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec2 delta = 1.0 / uResolution;\n  vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);\n\n  for (int index = -uKernalRadius; index <= uKernalRadius; index++) {\n    vec2 step = vec2(index, 0.0);\n    if (1 == uIsVertical) {\n      step = vec2(0.0, index);\n    }\n    vec2 offset = vTextCoord + step * delta;\n    outputColor += uKernelData[index + uKernalRadius] * texture(uSource, offset);\n  }\n\n  outColor = outputColor;\n}\n`;\n\nexport default gaussianBlurFragment;\n","// GaussianBlurFilter.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport gaussianBlurFragmentShaderSource from '../shaderSource/gaussianBlurFragment.js';\n\nconst getKernal = (inputRadius, sigma) => {\n  const radius = Math.floor(Math.abs(inputRadius));\n  const sigma2 = sigma * sigma;\n  const data = new Array(radius * 2 + 1);\n  let sum = 0;\n  for (let x = -radius; x <= radius; ++x) {\n    const index = x + radius;\n    data[index] =\n      Math.exp(-(x * x) / (2.0 * sigma2)) / Math.sqrt(2.0 * Math.PI * sigma2);\n    sum += data[index];\n  }\n  const normalizedData = data.map(value => value / sum);\n  return { data: new Float32Array(normalizedData), radius };\n};\n\nconst GaussianBlurFilter = function ({ context, radius = 16, sigma = 5 } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: gaussianBlurFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n  this.location.uResolution = context.getUniformLocation(\n    this.core.program,\n    'uResolution'\n  );\n  this.location.uKernalRadius = context.getUniformLocation(\n    this.core.program,\n    'uKernalRadius'\n  );\n  this.location.uKernelData = context.getUniformLocation(\n    this.core.program,\n    'uKernelData'\n  );\n  this.location.uIsVertical = context.getUniformLocation(\n    this.core.program,\n    'uIsVertical'\n  );\n\n  this.updateKernal({ radius, sigma });\n};\n\nGaussianBlurFilter.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nGaussianBlurFilter.prototype.updateKernal = function ({ radius, sigma } = {}) {\n  if (radius && isNaN(radius)) {\n    throw new Error('invalid radius');\n  }\n  if (radius && (32 < radius || 0 > radius)) {\n    throw new Error('radius must be [0, 32]');\n  }\n  if (sigma && isNaN(sigma)) {\n    throw new Error('invalid sigma');\n  }\n  if (sigma && 0 >= sigma) {\n    throw new Error('sigma must be > 0');\n  }\n  this._radius = radius || this._radius;\n  this._sigma = sigma || this._sigma;\n  this._kernal = getKernal(this._radius, this._sigma);\n\n  const context = this.context;\n  context.useProgram(this.core.program);\n  context.uniform1i(this.location.uKernalRadius, this._kernal.radius);\n  context.uniform1fv(this.location.uKernelData, this._kernal.data);\n};\n\nGaussianBlurFilter.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  midFrameBuffer,\n  midTexture,\n  midTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n  context.uniform2f(\n    this.location.uResolution,\n    context.canvas.width,\n    context.canvas.height\n  );\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n\n  context.bindFramebuffer(context.FRAMEBUFFER, midFrameBuffer);\n  context.uniform1i(this.location.uIsFrameBuffer, 1);\n  context.uniform1i(this.location.uIsVertical, 1);\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n\n  context.bindTexture(context.TEXTURE_2D, midTexture);\n  context.uniform1i(this.location.uSource, midTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.uniform1i(this.location.uIsVertical, 0);\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default GaussianBlurFilter;\n","// highPassFilterFragment.js\n\nconst highPassFilterFragment = `#version 300 es\nprecision highp float;\n\nuniform sampler2D uSource;\nuniform sampler2D uBlurredSource;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec4 originColor = texture(uSource, vTextCoord);\n  vec4 blurredColor = texture(uBlurredSource, vTextCoord);\n  outColor = originColor - blurredColor + vec4(0.5, 0.5, 0.5, 1.0);\n}\n`;\n\nexport default highPassFilterFragment;\n","// HighPassFilter.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport highPassFilterFragmentShaderSource from '../shaderSource/highPassFilterFragment.js';\n\nconst HighPassFilter = function ({ context } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: highPassFilterFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n  this.location.uBlurredSource = context.getUniformLocation(\n    this.core.program,\n    'uBlurredSource'\n  );\n};\n\nHighPassFilter.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nHighPassFilter.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  blurredSourceTexture,\n  blurredSourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n  context.bindTexture(context.TEXTURE_2D, blurredSourceTexture);\n  context.uniform1i(this.location.uBlurredSource, blurredSourceTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default HighPassFilter;\n","// hardLightFragment.js\n// https://github.com/YuAo/YUGPUImageHighPassSkinSmoothing/blob/master/Sources/YUGPUImageHighPassSkinSmoothingFilter.m#L19\n\nconst hardLightFragment = `#version 300 es\nprecision highp float;\n\nuniform int uCycles;\nuniform sampler2D uSource;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec4 originColor = texture(uSource, vTextCoord);\n\n  float color = originColor.b;\n  for (int i = 0; i < uCycles; ++i) {\n    if (color < 0.5) {\n      color = color * color * 2.0;\n    } else {\n      color = 1.0 - (1.0 - color) * (1.0 - color) * 2.0;\n    }\n  }\n\n  float k = 255.0 / (164.0 - 75.0);\n  color = (color - 75.0 / 255.0) * k;\n\n  outColor = vec4(color, color, color, originColor.a);;\n}\n`;\n\nexport default hardLightFragment;\n","// HardLight.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport hardLightFragmentShaderSource from '../shaderSource/hardLightFragment.js';\n\nconst HardLight = function ({ context, cycles = 3 } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: hardLightFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uCycles = context.getUniformLocation(\n    this.core.program,\n    'uCycles'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n\n  this.updateCycles({ cycles });\n};\n\nHardLight.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nHardLight.prototype.updateCycles = function ({ cycles } = {}) {\n  if (!cycles || isNaN(cycles)) {\n    throw new Error('invalid cycles argument');\n  }\n  this._cycles = Math.max(Math.floor(cycles), 0) || this._cycles;\n\n  const context = this.context;\n  context.useProgram(this.core.program);\n  context.uniform1i(this.location.uCycles, this._cycles);\n};\n\nHardLight.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default HardLight;\n","// CardinalSpline.js\n// https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\n\nconst h00 = t => (1 + 2 * t) * (1 - t) * (1 - t);\nconst h10 = t => t * (1 - t) * (1 - t);\nconst h01 = t => t * t * (3 - 2 * t);\nconst h11 = t => t * t * (t - 1);\n\nconst mk1 = ({ tension, k0, k2 }) =>\n  ((1 - tension) * (k2.y - k0.y)) / (k2.x - k0.x);\n\nconst getPolynomial = ({ tension, p0, p1, p2, p3 }) => {\n  return t =>\n    h00(t) * p1.y +\n    h10(t) * (p2.x - p1.x) * mk1({ tension, k0: p0, k2: p2 }) +\n    h01(t) * p2.y +\n    h11(t) * (p2.x - p1.x) * mk1({ tension, k0: p1, k2: p3 });\n};\n\nconst getPaddedPoints = ({ points }) => {\n  const p0 = points[0];\n  const p1 = points[1];\n  const ptail0 = points[points.length - 1];\n  const ptail1 = points[points.length - 2];\n  return [\n    { x: p0.x - (p1.x - p0.x), y: p0.y - (p1.y - p0.y) },\n    ...points,\n    {\n      x: ptail0.x + (ptail0.x - ptail1.x),\n      y: ptail0.y + (ptail0.y - ptail1.y),\n    },\n  ];\n};\n\nconst getPolynomials = ({\n  points = [\n    { x: 0, y: 0 },\n    { x: 255, y: 255 },\n  ],\n  tension = 0.5,\n} = {}) => {\n  const sortedPoints = points.sort((a, b) => a.x - b.x);\n  const padPoints = getPaddedPoints({ points: sortedPoints });\n  return sortedPoints.slice(0, -1).map((point, index) => {\n    return {\n      startPoint: point,\n      stopPoint: sortedPoints[index + 1],\n      length: sortedPoints[index + 1].x - point.x,\n      polynomial: getPolynomial({\n        tension,\n        p0: padPoints[index],\n        p1: padPoints[index + 1],\n        p2: padPoints[index + 2],\n        p3: padPoints[index + 3],\n      }),\n    };\n  });\n};\n\nconst getCurvePoint = ({ x, polynomials }) => {\n  const polynomial = polynomials.find(\n    p => p.startPoint.x <= x && p.stopPoint.x >= x\n  );\n  if (x === polynomial.startPoint.x) {\n    return { x, y: polynomial.startPoint.y };\n  }\n  const t = (x - polynomial.startPoint.x) / polynomial.length;\n  return { x, y: polynomial.polynomial(t) };\n};\n\nexport const getCurvePoints = ({\n  points = [\n    { x: 0, y: 0 },\n    { x: 255, y: 255 },\n  ],\n  tension = 0.5,\n} = {}) => {\n  const polynomials = getPolynomials({ points, tension });\n\n  return new Array(256).fill(0).map((_, index) => {\n    return getCurvePoint({ x: index, polynomials });\n  });\n};\n","// toneCurveFragment.js\n\nconst toneCurveFragment = `#version 300 es\nprecision highp float;\n\nuniform float uStrength;\nuniform sampler2D uSource;\nuniform sampler2D uTone;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec4 colorIndex = texture(uSource, vTextCoord);\n  float revStr = 1.0 - uStrength;\n  outColor = vec4(\n    uStrength * vec4(texture(uTone, vec2(colorIndex.r, 0))).r + revStr * colorIndex.r,\n    uStrength * vec4(texture(uTone, vec2(colorIndex.g, 0))).g + revStr * colorIndex.g,\n    uStrength * vec4(texture(uTone, vec2(colorIndex.b, 0))).b + revStr * colorIndex.b,\n    1.0\n  );\n}\n`;\n\nexport default toneCurveFragment;\n","// ToneCurve.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport { getCurvePoints } from '../resource/CardinalSpline.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport toneCurveFragmentShaderSource from '../shaderSource/toneCurveFragment.js';\n\nconst defaultRedControlPoints = [\n  { x: 0, y: 0 },\n  { x: 120, y: 146 }, // default\n  { x: 255, y: 255 },\n];\nconst defaultControlPoints = {\n  red: defaultRedControlPoints,\n  green: defaultRedControlPoints,\n  blue: defaultRedControlPoints,\n};\n\nconst ToneCurve = function ({\n  context,\n  toneMapTexture,\n  toneMapTextureIndex,\n  strength = 0.5,\n  controlPoints = defaultControlPoints,\n  tension = 0.5,\n} = {}) {\n  if (!context || !toneMapTexture || !toneMapTextureIndex) {\n    throw new Error('not enough arguments');\n  }\n  this.context = context;\n  this.toneMapTexture = toneMapTexture;\n  this.toneMapTextureIndex = toneMapTextureIndex;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: toneCurveFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uStrength = context.getUniformLocation(\n    this.core.program,\n    'uStrength'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n  this.location.uTone = context.getUniformLocation(this.core.program, 'uTone');\n\n  context.useProgram(this.core.program);\n  context.uniform1i(this.location.uTone, this.toneMapTextureIndex);\n\n  this.updateStrength({ strength });\n  this.updateCurvePoints({ controlPoints, tension });\n};\n\nToneCurve.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nToneCurve.prototype.updateStrength = function ({ strength } = {}) {\n  if (!strength || isNaN(strength)) {\n    throw new Error('invalid strength argument');\n  }\n  this._strength = Math.max(Math.min(strength, 1), 0) || this._strength;\n\n  const context = this.context;\n  context.useProgram(this.core.program);\n  context.uniform1f(this.location.uStrength, this._strength);\n};\n\nToneCurve.prototype.updateCurvePoints = function ({\n  controlPoints,\n  tension,\n} = {}) {\n  if (\n    controlPoints &&\n    (!controlPoints.red || !controlPoints.green || !controlPoints.blue)\n  ) {\n    throw new Error('invalid controlPoints argument');\n  }\n  if (tension && isNaN(tension)) {\n    throw new Error('invalid tension argument');\n  }\n  if (\n    (!controlPoints || controlPoints === this._controlPoints) &&\n    (!tension || tension === this._tension)\n  ) {\n    return;\n  }\n  this._controlPoints = controlPoints || this._controlPoints;\n  this._tension = tension || this._tension;\n  this._curvePoints = {\n    red: getCurvePoints({\n      points: this._controlPoints.red,\n      tension: this._tension,\n    }),\n    green: getCurvePoints({\n      points: this._controlPoints.green,\n      tension: this._tension,\n    }),\n    blue: getCurvePoints({\n      points: this._controlPoints.blue,\n      tension: this._tension,\n    }),\n  };\n  this._curveImageData = new ImageData(\n    new Uint8ClampedArray(\n      new Array(256)\n        .fill(0)\n        .flatMap((_, index) => [\n          this._curvePoints.red[index].y,\n          this._curvePoints.green[index].y,\n          this._curvePoints.blue[index].y,\n          255,\n        ])\n    ),\n    256\n  );\n};\n\nToneCurve.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n\n  context.bindTexture(context.TEXTURE_2D, this.toneMapTexture);\n  context.texImage2D(\n    context.TEXTURE_2D,\n    0, // mip level\n    context.RGBA, // internam format\n    context.RGBA, // src format\n    context.UNSIGNED_BYTE, // src type\n    this._curveImageData\n  );\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default ToneCurve;\n","// maskBlenderFragment.js\n\nconst maskBlenderFragment = `#version 300 es\nprecision highp float;\n\nuniform sampler2D uSource;\nuniform sampler2D uMask;\nuniform sampler2D uBlendSource;\nin vec2 vTextCoord;\n\nout vec4 outColor;\n\nvoid main() {\n  vec4 originColor = texture(uSource, vTextCoord);\n  vec4 maskColor = texture(uMask, vTextCoord);\n  vec4 blendColor = texture(uBlendSource, vTextCoord);\n  outColor = vec4(mix(originColor.rgb, blendColor.rgb, 1.0 - maskColor.b), 1.0);\n}\n`;\n\nexport default maskBlenderFragment;\n","// MaskBlender.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport maskBlenderFragmentShaderSource from '../shaderSource/maskBlenderFragment.js';\n\nconst MaskBlender = function ({ context } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: maskBlenderFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n  this.location.uMask = context.getUniformLocation(this.core.program, 'uMask');\n  this.location.uBlendSource = context.getUniformLocation(\n    this.core.program,\n    'uBlendSource'\n  );\n};\n\nMaskBlender.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nMaskBlender.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  maskTexture,\n  maskTextureIndex,\n  blendSourceTexture,\n  blendSourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n  context.bindTexture(context.TEXTURE_2D, maskTexture);\n  context.uniform1i(this.location.uMask, maskTextureIndex);\n  context.bindTexture(context.TEXTURE_2D, blendSourceTexture);\n  context.uniform1i(this.location.uBlendSource, blendSourceTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default MaskBlender;\n","// fillColorFragment.js\n\nconst fillColorFragment = `#version 300 es\nprecision highp float;\n\nuniform vec4 uColor;\nout vec4 outColor;\n\nvoid main() {\n  outColor = uColor;\n}\n`;\n\nexport default fillColorFragment;\n","// FillColor.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport fillColorFragmentShaderSource from '../shaderSource/fillColorFragment.js';\n\nconst FillColor = function ({ context, color = [0, 0, 0, 1] } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: fillColorFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uColor = context.getUniformLocation(\n    this.core.program,\n    'uColor'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n\n  this.updateColor({ color });\n};\n\nFillColor.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nFillColor.prototype.updateColor = function ({ color } = {}) {\n  if (color && (!Array.isArray(color) || 4 !== color.length)) {\n    throw new Error('invalid color argument');\n  }\n  this._color = color || this._color;\n\n  const context = this.context;\n  context.useProgram(this.core.program);\n  context.uniform4f(this.location.uColor, ...this._color);\n};\n\nFillColor.prototype.draw = function ({ targetFrameBuffer } = {}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default FillColor;\n","// mirrorFragment.js\n\nconst mirrorFragment = `#version 300 es\nprecision highp float;\n\nuniform sampler2D uSource;\nin vec2 vTextCoord;\nout vec4 outColor;\n\nvoid main() {\n  outColor = texture(uSource, vTextCoord);\n}\n`;\n\nexport default mirrorFragment;\n","// CopyTexture.js\nimport { createProgram, dockBuffer } from '../resource/WebGL.js';\nimport mirrorVertexShaderSource from '../shaderSource/mirrorVertex.js';\nimport mirrorFragmentShaderSource from '../shaderSource/mirrorFragment.js';\n\nconst CopyTexture = function ({ context } = {}) {\n  if (!context) {\n    throw new Error('need context arg');\n  }\n  this.context = context;\n\n  this.core = createProgram({\n    context,\n    vertexShaderSource: mirrorVertexShaderSource,\n    fragmentShaderSource: mirrorFragmentShaderSource,\n  });\n  this.buffer = {};\n\n  this.location = {};\n  this.location.aPosition = context.getAttribLocation(\n    this.core.program,\n    'aPosition'\n  );\n  this.location.aTextCoord = context.getAttribLocation(\n    this.core.program,\n    'aTextCoord'\n  );\n  context.enableVertexAttribArray(this.location.aPosition);\n  context.enableVertexAttribArray(this.location.aTextCoord);\n\n  this.location.uIsFrameBuffer = context.getUniformLocation(\n    this.core.program,\n    'uIsFrameBuffer'\n  );\n  this.location.uSource = context.getUniformLocation(\n    this.core.program,\n    'uSource'\n  );\n};\n\nCopyTexture.prototype.dockBuffer = function ({ key, buffer }) {\n  if (!['aPosition', 'aTextCoord'].includes(key)) {\n    throw new Error('invalid buffer name');\n  }\n  this.buffer[key] = buffer;\n  dockBuffer({ context: this.context, location: this.location[key], buffer });\n};\n\nCopyTexture.prototype.draw = function ({\n  sourceTexture,\n  sourceTextureIndex,\n  targetFrameBuffer,\n}) {\n  const context = this.context;\n  context.useProgram(this.core.program);\n\n  context.bindTexture(context.TEXTURE_2D, sourceTexture);\n  context.uniform1i(this.location.uSource, sourceTextureIndex);\n\n  if (targetFrameBuffer) {\n    context.bindFramebuffer(context.FRAMEBUFFER, targetFrameBuffer);\n    context.uniform1i(this.location.uIsFrameBuffer, 1);\n  } else {\n    context.bindFramebuffer(context.FRAMEBUFFER, null);\n    context.uniform1i(this.location.uIsFrameBuffer, 0);\n  }\n  context.drawArrays(context.TRIANGLES, 0, this.buffer.aPosition.count);\n};\n\nexport default CopyTexture;\n","// BeautifyFilter.js\nimport { createBuffer, createTexture } from '../resource/WebGL.js';\nimport GreenBlueChannel from '../resource/GreenBlueChannel.js';\nimport GaussianBlurFilter from '../resource/GaussianBlurFilter.js';\nimport HighPassFilter from '../resource/HighPassFilter.js';\nimport HardLight from '../resource/HardLight.js';\nimport ToneCurve from '../resource/ToneCurve.js';\nimport MaskBlender from '../resource/MaskBlender.js';\nimport FillColor from '../resource/FillColor.js';\nimport CopyTexture from '../resource/CopyTexture.js';\n\nconst textureNames = [\n  'source',\n  'greenBlueChannel',\n  'gaussianBlurMid',\n  'gaussianBlur',\n  'highPassFilter',\n  'hardLight',\n  'toneMap',\n  'toneCurve',\n  'maskBlender',\n];\nconst frameBufferNames = [\n  'greenBlueChannel',\n  'gaussianBlurMid',\n  'gaussianBlur',\n  'highPassFilter',\n  'hardLight',\n  'toneCurve',\n  'maskBlender',\n];\nconst textureIndex = textureNames.reduce(\n  (current, textureName, index) => ({ ...current, [textureName]: index }),\n  {}\n);\nconst clearColor = [0, 0, 0, 0];\nconst positionAttribute = {\n  array: [-1, -1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1],\n  numComponents: 2,\n};\nconst textCoordAttribute = {\n  array: [0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0],\n  numComponents: 2,\n};\n\nconst BeautifyFilter = function () {\n  const canvas = document.createElement('canvas');\n  this.canvas = canvas;\n\n  const context = canvas.getContext('webgl2');\n  this.context = context;\n\n  this.slice = textureNames.reduce(\n    (current, textureName) => ({ ...current, [textureName]: [] }),\n    {}\n  );\n\n  this.buffer = {};\n  this.buffer.aPosition = createBuffer({\n    context,\n    attribute: positionAttribute,\n  });\n  this.buffer.aTextCoord = createBuffer({\n    context,\n    attribute: textCoordAttribute,\n  });\n\n  this.texture = {};\n  textureNames.forEach(name => {\n    this.texture[name] = createTexture({ context, index: textureIndex[name] });\n  });\n\n  this.frameBuffer = {};\n  frameBufferNames.forEach(name => {\n    this.frameBuffer[name] = context.createFramebuffer();\n    context.bindFramebuffer(context.FRAMEBUFFER, this.frameBuffer[name]);\n    context.framebufferTexture2D(\n      context.FRAMEBUFFER,\n      context.COLOR_ATTACHMENT0,\n      context.TEXTURE_2D,\n      this.texture[name],\n      0 // level\n    );\n  });\n\n  this.greenBlueChannel = new GreenBlueChannel({ context: this.context });\n  this.greenBlueChannel.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.greenBlueChannel.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.gaussianBlur = new GaussianBlurFilter({ context: this.context });\n  this.gaussianBlur.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.gaussianBlur.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.highPassFilter = new HighPassFilter({ context: this.context });\n  this.highPassFilter.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.highPassFilter.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.hardLight = new HardLight({ context: this.context });\n  this.hardLight.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.hardLight.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.toneCurve = new ToneCurve({\n    context: this.context,\n    toneMapTexture: this.texture.toneMap,\n    toneMapTextureIndex: textureIndex.toneMap,\n  });\n  this.toneCurve.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.toneCurve.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.maskBlender = new MaskBlender({ context: this.context });\n  this.maskBlender.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.maskBlender.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.fillColor = new FillColor({ context: this.context, color: clearColor });\n  this.fillColor.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.fillColor.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n\n  this.copyTexture = new CopyTexture({ context: this.context });\n  this.copyTexture.dockBuffer({\n    key: 'aPosition',\n    buffer: this.buffer.aPosition,\n  });\n  this.copyTexture.dockBuffer({\n    key: 'aTextCoord',\n    buffer: this.buffer.aTextCoord,\n  });\n};\n\nBeautifyFilter.prototype.draw = function ({ pixelSource }) {\n  if (!pixelSource || !this.context) {\n    return;\n  }\n\n  this.updateCanvasSize({ pixelSource });\n\n  const context = this.context;\n  context.clearColor(...clearColor);\n  context.clear(context.COLOR_BUFFER_BIT);\n\n  context.bindTexture(context.TEXTURE_2D, this.texture.source);\n  context.texImage2D(\n    context.TEXTURE_2D,\n    0, // mip level\n    context.RGBA, // internam format\n    context.RGBA, // src format\n    context.UNSIGNED_BYTE, // src type\n    pixelSource\n  );\n\n  this.exportTextureToCanvases({\n    texture: this.texture.source,\n    textureIndex: textureIndex.source,\n    canvases: this.slice['source'],\n  });\n\n  this.greenBlueChannel.draw({\n    sourceTexture: this.texture.source,\n    sourceTextureIndex: textureIndex.source,\n    targetFrameBuffer: this.frameBuffer.greenBlueChannel,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.greenBlueChannel,\n    textureIndex: textureIndex.greenBlueChannel,\n    canvases: this.slice['greenBlueChannel'],\n  });\n\n  this.gaussianBlur.draw({\n    sourceTexture: this.texture.greenBlueChannel,\n    sourceTextureIndex: textureIndex.greenBlueChannel,\n    midFrameBuffer: this.frameBuffer.gaussianBlurMid,\n    midTexture: this.texture.gaussianBlurMid,\n    midTextureIndex: textureIndex.gaussianBlurMid,\n    targetFrameBuffer: this.frameBuffer.gaussianBlur,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.gaussianBlur,\n    textureIndex: textureIndex.gaussianBlur,\n    canvases: this.slice['gaussianBlur'],\n  });\n\n  this.highPassFilter.draw({\n    sourceTexture: this.texture.greenBlueChannel,\n    sourceTextureIndex: textureIndex.greenBlueChannel,\n    blurredSourceTexture: this.texture.gaussianBlur,\n    blurredSourceTextureIndex: textureIndex.gaussianBlur,\n    targetFrameBuffer: this.frameBuffer.highPassFilter,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.highPassFilter,\n    textureIndex: textureIndex.highPassFilter,\n    canvases: this.slice['highPassFilter'],\n  });\n\n  this.hardLight.draw({\n    sourceTexture: this.texture.highPassFilter,\n    sourceTextureIndex: textureIndex.highPassFilter,\n    targetFrameBuffer: this.frameBuffer.hardLight,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.hardLight,\n    textureIndex: textureIndex.hardLight,\n    canvases: this.slice['hardLight'],\n  });\n\n  this.toneCurve.draw({\n    sourceTexture: this.texture.source,\n    sourceTextureIndex: textureIndex.source,\n    targetFrameBuffer: this.frameBuffer.toneCurve,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.toneCurve,\n    textureIndex: textureIndex.toneCurve,\n    canvases: this.slice['toneCurve'],\n  });\n\n  this.maskBlender.draw({\n    sourceTexture: this.texture.source,\n    sourceTextureIndex: textureIndex.source,\n    maskTexture: this.texture.hardLight,\n    maskTextureIndex: textureIndex.hardLight,\n    blendSourceTexture: this.texture.toneCurve,\n    blendSourceTextureIndex: textureIndex.toneCurve,\n    targetFrameBuffer: this.frameBuffer.maskBlender,\n  });\n\n  this.exportTextureToCanvases({\n    texture: this.texture.maskBlender,\n    textureIndex: textureIndex.maskBlender,\n    canvases: this.slice['maskBlender'],\n  });\n\n  this.copyTexture.draw({\n    sourceTexture: this.texture.maskBlender,\n    sourceTextureIndex: textureIndex.maskBlender,\n  });\n};\n\nBeautifyFilter.prototype.updateCanvasSize = function ({ pixelSource }) {\n  if (!pixelSource || !this.context) {\n    return;\n  }\n\n  const context = this.context;\n  let sourceWidth = this.context.canvas.width;\n  let sourceHeight = this.context.canvas.height;\n  if ('VIDEO' === pixelSource.nodeName) {\n    sourceWidth = pixelSource.videoWidth;\n    sourceHeight = pixelSource.videoHeight;\n  } else if ('CANVAS' === pixelSource.nodeName) {\n    sourceWidth = pixelSource.width;\n    sourceHeight = pixelSource.height;\n  }\n\n  const canvasWidth = context.canvas.width;\n  const canvasHeight = context.canvas.height;\n  if (canvasWidth !== sourceWidth || canvasHeight !== sourceHeight) {\n    context.canvas.width = sourceWidth;\n    context.canvas.height = sourceHeight;\n    context.viewport(0, 0, sourceWidth, sourceHeight);\n    // update texture sizes\n    Object.keys(this.texture).forEach(textureKey => {\n      const texture = this.texture[textureKey];\n      context.bindTexture(context.TEXTURE_2D, texture);\n      context.texImage2D(\n        context.TEXTURE_2D,\n        0, // level\n        context.RGBA, // internal format\n        sourceWidth,\n        sourceHeight,\n        0, // border\n        context.RGBA, // src format\n        context.UNSIGNED_BYTE, // src type\n        null\n      );\n    });\n  }\n};\n\nBeautifyFilter.prototype.registerSlice = function ({\n  key = 'greenBlueChannel',\n  canvas,\n}) {\n  if (!textureNames.includes(key) || !canvas || 'CANVAS' !== canvas.nodeName) {\n    return;\n  }\n  return this.slice[key].push(canvas);\n};\n\nBeautifyFilter.prototype.exportTextureToCanvases = function ({\n  texture,\n  textureIndex,\n  canvases,\n}) {\n  if (!texture || isNaN(textureIndex) || !canvases?.length) return;\n\n  const targetContexts = canvases\n    .map(canvas => {\n      if ('CANVAS' !== canvas?.nodeName) return;\n      return canvas.getContext('2d');\n    })\n    .filter(Boolean);\n  if (!targetContexts.length) return;\n\n  this.copyTexture.draw({\n    sourceTexture: texture,\n    sourceTextureIndex: textureIndex,\n  });\n\n  targetContexts.forEach(targetContext => {\n    const sourceCanvas = this.canvas;\n    const sourceWidth = sourceCanvas.width;\n    const sourceHeight = sourceCanvas.height;\n\n    const targetWidth = targetContext.canvas.width;\n    const targetHeight = targetContext.canvas.height;\n\n    if (targetWidth !== sourceWidth || targetHeight !== sourceHeight) {\n      targetContext.canvas.width = sourceWidth;\n      targetContext.canvas.height = sourceHeight;\n    }\n    targetContext.clearRect(0, 0, sourceWidth, sourceHeight);\n    targetContext.drawImage(sourceCanvas, 0, 0);\n  });\n\n  this.fillColor.draw();\n};\n\nBeautifyFilter.prototype.updateGaussianBlurKernal = function ({\n  radius,\n  sigma,\n} = {}) {\n  return this.gaussianBlur.updateKernal({ radius, sigma });\n};\n\nBeautifyFilter.prototype.updateHardLightCycles = function ({ cycles } = {}) {\n  return this.hardLight.updateCycles({ cycles });\n};\n\nexport default BeautifyFilter;\n","// Main.jsx\nimport React, { useState, useRef, useEffect } from 'react';\nimport styled from 'styled-components';\n\nimport MediaStreamHandler from '../component/MediaStreamHandler.jsx';\nimport FilterPanel from '../component/FilterPanel.jsx';\nimport SliceMonitor from '../component/SliceMonitor.jsx';\nimport GaussianBlurPanel from '../component/GaussianBlurPanel.jsx';\nimport HardLightPanel from '../component/HardLightPanel.jsx';\n\nimport BeautifyFilter from '../resource/BeautifyFilter.js';\n\nconst Main = () => {\n  const [mediaStream, setMediaStream] = useState();\n  const [gaussianBlur, setGaussianBlur] = useState({ radius: 16, sigma: 5 });\n  const [hardLight, setHardLight] = useState({ cycles: 3 });\n  const sourceVideo = useRef();\n  const beautifyFilter = useRef();\n  const sourceCanvasRef = useRef();\n  const greenBlueCanvasRef = useRef();\n  const gaussianBlurCanvasRef = useRef();\n  const hardLightCanvasRef = useRef();\n  const toneCurveCanvasRef = useRef();\n\n  useEffect(() => {\n    const video = document.createElement('video');\n    // required to tell iOS safari we don't want fullscreen\n    video.setAttribute('playsinline', true);\n    sourceVideo.current = video;\n\n    beautifyFilter.current = new BeautifyFilter();\n    window.beautifyFilter = beautifyFilter.current;\n    beautifyFilter.current.registerSlice({\n      key: 'source',\n      canvas: sourceCanvasRef.current,\n    });\n    beautifyFilter.current.registerSlice({\n      key: 'greenBlueChannel',\n      canvas: greenBlueCanvasRef.current,\n    });\n    beautifyFilter.current.registerSlice({\n      key: 'gaussianBlur',\n      canvas: gaussianBlurCanvasRef.current,\n    });\n    beautifyFilter.current.registerSlice({\n      key: 'hardLight',\n      canvas: hardLightCanvasRef.current,\n    });\n    beautifyFilter.current.registerSlice({\n      key: 'toneCurve',\n      canvas: toneCurveCanvasRef.current,\n    });\n    return () => {\n      video.srcObject = null;\n      return video.pause();\n    };\n  }, []);\n\n  useEffect(() => {\n    sourceVideo.current.srcObject = mediaStream;\n    if (mediaStream) {\n      sourceVideo.current.play();\n    } else {\n      sourceVideo.current.pause();\n    }\n  }, [mediaStream]);\n\n  useEffect(() => {\n    beautifyFilter.current.updateGaussianBlurKernal(gaussianBlur);\n  }, [gaussianBlur]);\n\n  useEffect(() => {\n    beautifyFilter.current.updateHardLightCycles(hardLight);\n  }, [hardLight]);\n\n  return (\n    <StyledMain>\n      <MediaStreamHandler onChange={({ value }) => setMediaStream(value)} />\n      <Modules>\n        <ModuleWrapper>\n          <FilterPanel\n            filterName=\"BeautifyFilterPanel\"\n            filterCore={beautifyFilter.current}\n            pixelSource={sourceVideo.current}\n          />\n        </ModuleWrapper>\n        <ModuleWrapper>\n          <SliceMonitor sliceName=\"Source\" canvasRef={sourceCanvasRef} />\n        </ModuleWrapper>\n        <ModuleWrapper>\n          <SliceMonitor\n            sliceName=\"GreenBlueChannel\"\n            canvasRef={greenBlueCanvasRef}\n          />\n        </ModuleWrapper>\n        <ModuleWrapper>\n          <GaussianBlurPanel\n            canvasRef={gaussianBlurCanvasRef}\n            radius={gaussianBlur.radius}\n            sigma={gaussianBlur.sigma}\n            onChange={setGaussianBlur}\n          />\n        </ModuleWrapper>\n        <ModuleWrapper>\n          <HardLightPanel\n            canvasRef={hardLightCanvasRef}\n            cycles={hardLight.cycles}\n            onChange={setHardLight}\n          />\n        </ModuleWrapper>\n        <ModuleWrapper>\n          <SliceMonitor sliceName=\"ToneCurve\" canvasRef={toneCurveCanvasRef} />\n        </ModuleWrapper>\n      </Modules>\n    </StyledMain>\n  );\n};\n\nconst StyledMain = styled.div`\n  padding: 8px;\n`;\n\nconst Modules = styled.div`\n  display: grid;\n  gap: 8px;\n  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\n  margin-top: 8px;\n`;\n\nconst ModuleWrapper = styled.div``;\n\nexport default Main;\n","export default __webpack_public_path__ + \"img/github-icon.e1201fcc.svg\";","// Footer.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport styled from 'styled-components';\n\nimport EmailIcon from '../../img/email-icon.svg';\nimport GithubIcon from '../../img/github-icon.svg';\n\nexport class Footer extends React.PureComponent {\n  render() {\n    const { email, github } = this.props;\n    return (\n      <StyledFooter>\n        <Link href={github} target=\"_blank\">\n          <img src={GithubIcon} alt=\"github\" />\n        </Link>\n        <Link href={`mailto:${email}`} target=\"_blank\">\n          <img src={EmailIcon} alt=\"email\" />\n        </Link>\n      </StyledFooter>\n    );\n  }\n}\n\nFooter.propTypes = {\n  email: PropTypes.string,\n  github: PropTypes.string,\n};\n\nFooter.defaultProps = {\n  email: 'bill42362@gmail.com',\n  github: 'https://github.com/bill42362/portfolio',\n};\n\nconst StyledFooter = styled.div`\n  flex: auto;\n  display: flex;\n  justify-content: center;\n  align-items: flex-end;\n  padding: 20px;\n`;\n\nconst Link = styled.a`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-radius: 50%;\n  width: 36px;\n  height: 36px;\n  background-color: #576574;\n\n  & + & {\n    margin-left: 8px;\n  }\n  img {\n    width: 60%;\n    height: auto;\n  }\n`;\n\nexport default Footer;\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNNDY3LDYxSDQ1QzIwLjIxOCw2MSwwLDgxLjE5NiwwLDEwNnYzMDBjMCwyNC43MiwyMC4xMjgsNDUsNDUsNDVoNDIyYzI0LjcyLDAsNDUtMjAuMTI4LDQ1LTQ1VjEwNiBDNTEyLDgxLjI4LDQ5MS44NzIsNjEsNDY3LDYxeiBNNDYwLjc4Niw5MUwyNTYuOTU0LDI5NC44MzNMNTEuMzU5LDkxSDQ2MC43ODZ6IE0zMCwzOTkuNzg4VjExMi4wNjlsMTQ0LjQ3OSwxNDMuMjRMMzAsMzk5Ljc4OHogTTUxLjIxMyw0MjFsMTQ0LjU3LTE0NC41N2w1MC42NTcsNTAuMjIyYzUuODY0LDUuODE0LDE1LjMyNyw1Ljc5NSwyMS4xNjctMC4wNDZMMzE3LDI3Ny4yMTNMNDYwLjc4Nyw0MjFINTEuMjEzeiBNNDgyLDM5OS43ODcgTDMzOC4yMTMsMjU2TDQ4MiwxMTIuMjEyVjM5OS43ODd6Ii8+PC9zdmc+\"","export default __webpack_public_path__ + \"img/x-men-school.0928a818.svg\";","// App.jsx\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { hot } from 'react-hot-loader/root';\nimport styled, {\n  createGlobalStyle,\n  StyleSheetManager,\n} from 'styled-components';\nimport styledNormalize from 'styled-normalize';\nimport { Helmet } from 'react-helmet';\n\nimport Main from '../component/Main.jsx';\nimport Footer from '../component/Footer.jsx';\n\nimport XMenLogoSource from '../../img/x-men-school.svg';\n\nconst GlobalStyle = createGlobalStyle`\n  ${styledNormalize};\n  *, ::after, ::before { box-sizing: border-box; }\n  body {\n    background-color: #101010;\n    color: #efefef;\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\",\n      Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n    font-weight: 400;\n    -webkit-tap-highlight-color: transparent;\n    overscroll-behavior-y: contain;\n  }\n  button {\n    background-color: rgba(0, 0, 0, 0);\n    cursor: pointer;\n    &:disabled {\n      cursor: not-allowed;\n    }\n  }\n  input::placeholder,\n  input::-webkit-input-placeholder,\n  input::-moz-placeholder {\n    line-height: normal !important;\n    vertical-align: middle;\n  }\n  a { color: inherit; text-decoration: none; }\n  a > * { opacity: inherit; }\n  a:hover { opacity: .7; }\n`;\n\nconst title = 'Portfolio';\nconst description = \"Bill's portfolio\";\n\nconst App = ({ request }) => {\n  // eslint-disable-next-line no-console\n  console.log('App() request:', request);\n  return (\n    <>\n      <Helmet defaultTitle=\"Portfolio\" titleTemplate=\"%s - Portfolio\">\n        <meta charSet=\"utf-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n\n        <meta name=\"author\" content=\"Bill\" />\n        <meta name=\"description\" content={description} />\n\n        <meta\n          property=\"og:url\"\n          content=\"https://github.com/bill42362/portfolio\"\n        />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:title\" content={title} />\n        <meta property=\"og:description\" content={description} />\n        <meta property=\"og:site_name\" content={title} />\n        <meta property=\"twitter:card\" content=\"summary\" />\n        <meta property=\"twitter:site\" content=\"@bill_portfolio\" />\n        {/* <meta property=\"twitter:image\" content={twitterImageSource} /> */}\n      </Helmet>\n      <GlobalStyle />\n      <StyledApp>\n        {!window && <img src={XMenLogoSource} title=\"Xavier school\" />}\n        <Main />\n        <Footer />\n      </StyledApp>\n    </>\n  );\n};\n\nApp.propTypes = {\n  request: PropTypes.object,\n};\n\nApp.defaultProps = {\n  request: null,\n};\n\nconst StyledApp = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  min-height: 100vh;\n  background-color: #222f3e;\n`;\n\nconst Body = ({ sheet, ...props }) => {\n  if (sheet.instance) {\n    return (\n      <StyleSheetManager sheet={sheet.instance}>\n        <App {...props} />\n      </StyleSheetManager>\n    );\n  } else {\n    return <App {...props} />;\n  }\n};\n\nBody.propTypes = {\n  ...App.propTypes,\n  sheet: PropTypes.object,\n};\n\nBody.defaultProps = {\n  ...App.defaultProps,\n  sheet: {},\n};\n\nexport default hot(Body);\n","// index.js\n'use strict';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './component/App.jsx';\n\nReactDOM.render(<App />, document.getElementById('app-root'));\n"],"sourceRoot":""}